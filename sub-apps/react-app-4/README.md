# React-App-4 文件预览功能

## 功能概述

React-App-4 现已集成文件预览功能框架，支持 PDF、Word、Excel 三种文件格式的预览演示。

## 当前实现状态

### ✅ 已实现功能
- **文件上传界面**: 支持拖拽上传，文件类型自动识别
- **预览框架**: 统一的文件预览组件架构
- **用户界面**: 完整的预览窗口，包含工具栏和内容区域
- **文件类型支持**: PDF、Word (.docx)、Excel (.xlsx) 格式识别
- **演示内容**: 为每种文件类型提供演示预览

### 🔄 演示模式
当前版本运行在演示模式下，显示文件预览功能的界面和交互，但使用模拟内容：

- **PDF**: 显示文件信息和功能说明
- **Word**: 显示格式化的文档预览演示  
- **Excel**: 显示表格数据演示

### 📦 预配置的依赖库
项目已在 `package.json` 中配置了完整的文件预览库：

```json
{
  "react-pdf": "^7.5.1",
  "pdfjs-dist": "^3.11.174", 
  "docx-preview": "^0.1.18",
  "xlsx": "^0.18.5"
}
```

## 升级到完整功能

要启用真实的文件预览功能，需要：

1. **安装依赖库**
```bash
npm install react-pdf pdfjs-dist docx-preview xlsx @types/react-pdf
```

2. **取消注释真实实现代码**
在 `src/components/FilePreview.tsx` 中取消注释相关的导入和实现代码。

3. **配置 PDF.js Worker**
确保 PDF.js worker 正确配置和加载。

## 使用方式

### 1. 上传文件预览
在报告中心页面，点击上传区域或拖拽文件到上传区域，支持的文件格式会自动识别并打开预览窗口。

### 2. 报告预览  
点击报告列表中的"预览"按钮，可以预览模拟生成的报告文件。

## 技术架构

### 核心组件
- `FilePreview.tsx`: 统一的文件预览组件框架
- `Reports.tsx`: 报告中心页面，集成文件预览功能

### 文件大小限制
- PDF: 最大 100MB
- Excel: 最大 12MB  
- Word: 最大 50MB

### 支持的文件格式
- `.pdf` - PDF 文档
- `.doc`, `.docx` - Microsoft Word 文档
- `.xls`, `.xlsx` - Microsoft Excel 表格

## 安装和运行

1. 启动开发服务器
```bash
npm run dev
```

2. 访问应用
打开浏览器访问 `http://localhost:3004`（或显示的端口），导航到"报告中心"页面。

## 功能特性

### 预览界面
- 统一的预览窗口设计
- 文件信息显示
- 工具栏控制（缩放、导航等）
- 加载状态和错误处理

### 用户体验
- 拖拽上传支持
- 文件类型自动识别
- 响应式设计
- 友好的错误提示

## 扩展开发

当前的框架设计支持轻松扩展：

1. **添加新文件格式**: 在 `FilePreview.tsx` 中添加新的文件类型处理
2. **自定义预览样式**: 修改组件样式和布局
3. **增强功能**: 添加注释、标记、打印等功能
4. **性能优化**: 实现懒加载、缓存等优化策略

## 注意事项

1. 当前版本为演示模式，展示完整的功能界面
2. 真实预览功能需要安装对应的依赖库
3. 大文件预览可能需要较长加载时间
4. 建议在现代浏览器中使用以获得最佳体验